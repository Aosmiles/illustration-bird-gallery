---
import { Image } from '@astrojs/image/components';
import { v2 as cloudinary } from 'cloudinary';

export interface props {
  cloudFolder: string;
}

const { cloudFolder } = Astro.props;

const cloud_images = await cloudinary.search.expression(`folder:${cloudFolder}/*`)
  .sort_by('public_id','asc')
  .max_results(30)
  .execute()
  .then(res => {
    return res.resources
  });
---

<ul class="gallery">
  {
    cloud_images.map((img: { url: any; width: number; height: number; }) => (
      <li>
        <a href={img.url}
            data-pswp-width={img.width} 
            data-pswp-height={img.height} 
            target="_blank">
          <Image
            src={img.url}
            width={200}
            aspectRatio={img.width / img.height}
            class="gallery__image"
            />
        </a>
      </li>
    ))
  }
</ul>

<style>

</style>

<script type="module">
  
</script>